<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="js/rem.js"></script>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="font/iconfont.css">
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/index.js"></script>
    <script src="js/echarts.common.min.js"></script>
    <title>Document</title>
</head>
<body>
   <div class="select">
        <div class="search">
            <input type="text" placeholder="搜索市丶区丶县等">
            <span>取消</span>
            <img src="img/sou.png" alt="">
        </div>
       <div class="dingwei">
           <span>当前定位</span>
           <p>太原</p>
       </div>
       <div class="history">
               <span>历史记录</span>
               <img src="img/shanchu.png" alt="">
       </div>
     <div class="twos">

     </div>
       <div class="hotview">
           <div class="viewlist">
               <ul>

               </ul>
           </div>
       </div>


   </div>
    <div class="top">
        <div class="container">
            <div class="top-left">腾讯天气</div>
            <div class="top-right">
            </div>
        </div>
    </div>
        <div class="main">
            <div class="container">
                <div class="main-center">
                    <i class="iconfont icon-weizhi"></i>
                    <span></span>
                </div>
                <div class="main-img">
                    <img src="img/right.png" alt="">
                </div>
                <div class="main-left">
                    <p>空气</p>
                    <p></p>
                </div>
                <div class="main-text">
                    <div class="main-text-top">
                        <p></p>
                        <p></p>
                    </div>
                    <p></p>
                    <div class="main-text-bottom">
                        <p>湿度</p>
                        <span>28%</span>
                    </div>

                </div>
                <div class="main-wenzi">天气冷了,注意保暖~</div>
                <div class="main-imges">
                    <img src="img/screen.png" alt="">
                </div>
            </div>
        </div>
    <div class="center">
        <div class="container">
            <div class="center-left">
                <div class="center-left-top">
                    <span>今天</span>
                    <span><i></i>/<i></i></span>
                </div>
                <div class="center-left-bottom">
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div class="center-right">
                <div class="center-right-top">
                    <span>明天</span>
                    <span>
                        <i></i>/<i></i>
                    </span>
                </div>
                <div class="center-right-bottom">
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </div>
     <div class="weather">
         <div class="container">
             <!-- <div class="weather-one">
                 <span>12:00</span>
                 <span><img src="img/0.png" alt=""></span>
                 <span>-1°</span>
             </div>
 -->
         </div>
     </div>
      <div class="other">
          <div class="container">
              <div class="other-one">

                  <!--<div class="other-one-first">-->
                      <!--<span>今天</span>-->
                      <!--<span>01/16</span>-->
                  <!--</div>-->
                  <!--<div class="other-one-first">-->
                      <!--<span>明天</span>-->
                      <!--<span>01/17</span>-->
                  <!--</div>-->
                  <!--<div class="other-one-first">-->
                        <!--<span>后天</span>-->
                        <!--<span>01/18</span>-->
                  <!--</div>-->
                  <!--<div class="other-one-first">-->
                      <!--<span>大后天</span>-->
                      <!--<span>01/19</span>-->
                  <!--</div>-->
                  <!--<div class="other-one-first">-->
                      <!--<span>最后天</span>-->
                      <!--<span>01/20</span>-->
                  <!--</div>-->
              </div>
              <div class="other-two">

                  <!--<div class="other-two-first">-->
                      <!--<span>晴</span>-->
                      <!--<img src="img/0.png" alt="">-->
                  <!--</div>-->
                  <!--<div class="other-two-first">-->
                      <!--<span>晴</span>-->
                      <!--<img src="img/0.png" alt="">-->
                  <!--</div>-->
                  <!--<div class="other-two-first">-->
                      <!--<span>多云</span>-->
                      <!--<img src="img/1.png" alt="">-->
                  <!--</div>-->
                  <!--<div class="other-two-first">-->
                      <!--<span>晴</span>-->
                      <!--<img src="img/0.png" alt="">-->
                  <!--</div>-->
                  <!--<div class="other-two-first">-->
                      <!--<span>晴</span>-->
                      <!--<img src="img/0.png" alt="">-->
                  <!--</div>-->

              </div>

              <div id="main"></div>
              <!--<div id="main" style="width: 6.7rem; height: 1.8rem; margin-top: 0.55rem"></div>-->
              <div class="other-twos">
                  <div class="other-twos-first">
                      <img src="img/31.png" alt="">
                      <span style="color: #cccccc">多云</span>
                  </div>
                  <div class="other-twos-first">
                      <img src="img/30.png" alt="">
                      <span>晴</span>
                  </div>
                  <div class="other-twos-first">
                      <img src="img/30.png" alt="">
                      <span>晴</span>
                  </div>
                  <div class="other-twos-first">
                      <img src="img/31.png" alt="">
                      <span>多云</span>
                  </div>
                  <div class="other-twos-first">
                      <img src="img/30.png" alt="">
                      <span>晴</span>
                  </div>
                  <div class="other-twos-first">
                      <img src="img/30.png" alt="">
                      <span>晴</span>
                  </div>
              </div>
              <div class="other-ones">

                  <!--<div class="other-ones-first">-->
                      <!--<span>西南风</span>-->
                      <!--<span>3级</span>-->
                  <!--</div>-->
                  <!--<div class="other-ones-first">-->
                      <!--<span>西北风</span>-->
                      <!--<span>3级</span>-->
                  <!--</div>-->
                  <!--<div class="other-ones-first">-->
                      <!--<span>西风</span>-->
                      <!--<span>3级</span>-->
                  <!--</div>-->
                  <!--<div class="other-ones-first">-->
                      <!--<span>西风</span>-->
                      <!--<span>3级</span>-->
                  <!--</div>-->
                  <!--<div class="other-ones-first">-->
                      <!--<span>西风</span>-->
                      <!--<span>3级</span>-->
                  <!--</div>-->
              </div>
          </div>
      </div>
      <div class="bottom">
          <div class="container">
                <div class="bottom-one">
                    <img src="img/yusan.png" alt="">
                    <span>不带伞</span>
                    <span>雨伞</span>
                </div>
              <div class="bottom-one">
                  <img src="img/yifu.png" alt="">
                  <span>冷</span>
                  <span>穿衣</span>
              </div>
              <div class="bottom-one">
                  <img src="img/taiyang.png" alt="">
                  <span>较弱</span>
                  <span>防晒</span>
              </div>
              <div class="bottom-one">
                  <img src="img/yao.png" alt="">
                  <span>较易发</span>
                  <span>感冒</span>
              </div>
              <div class="bottom-one">
                  <img src="img/qiu.png" alt="">
                  <span>较不宜</span>
                  <span>运动</span>
              </div>
              <div class="bottom-one">
                  <img src="img/YU.png" alt="">
                  <span>较不宜</span>
                  <span>钓鱼</span>
              </div>
              <div class="bottom-one">
                  <img src="img/QICHE.png" alt="">
                  <span>较不宜</span>
                  <span>洗车</span>
              </div>
              <div class="bottom-one">
                  <img src="img/HONGLV.png" alt="">
                  <span>良好</span>
                  <span>交通</span>
              </div>
          </div>
      </div>
<div class="footer">
    数据来源于中国天气网
</div>
</body>
</html>
<script>
    let tianqi;
    $.ajax({
        type:"get",
        url:"https://www.toutiao.com/stream/widget/local_weather/data/?city=太原",
        dataType:"jsonp",
        success:function (obj) {
            tianqi=obj.data;
            console.log(tianqi);
            updata(tianqi);
        }
    })

    function updata(tianqi) {
        //获取当前城市天气
        $(".main-center>span").html(tianqi.city);
        $(".main-text-top>p:nth-child(1)").html(tianqi.weather.current_temperature);
        $(".main-text > p").html(tianqi.weather.current_condition);
        $(".main-left > p:nth-child(2)").html(tianqi.weather.quality_level);
        $(".center-left-bottom > span:nth-child(1)").html(tianqi.weather.current_condition);
        $(".center-right-bottom > span:nth-child(1)").html(tianqi.weather.tomorrow_condition);
        $(".center-right-top> span:nth-child(2)>i:nth-child(1)").html(tianqi.weather.tomorrow_high_temperature);
        $(".center-right-top> span:nth-child(2)>i:nth-child(2)").html(tianqi.weather.tomorrow_low_temperature+"℃");
        $(".center-left-top> span:nth-child(2)>i:nth-child(1)").html(tianqi.weather.dat_high_temperature);
        $(".center-left-top> span:nth-child(2)>i:nth-child(2)").html(tianqi.weather.dat_low_temperature+"℃");
        //未来24小时天气
        let hweather =tianqi.weather.hourly_forecast;

        hweather.forEach(function (v) {
          // $(".weather-one").css("display","none");
            let str=`
            <div class="weather-one">
                 <span>${v.hour}:00</span>
                 <span><img src="./img/${v.weather_icon_id}.png" alt=""></span>
                 <span>${v.temperature}°</span>
             </div>`
            $(".weather>div.container").append(str);
        })

        let dweather = tianqi.weather.forecast_list;
        let arrdata=[];
        let arrhigh=[];
        let arrlow=[];
        for(let i=0; i<6;i++){

            let str=`<div class="other-one-first">
                       <span>${dweather[i].date}</span>
                       <span></span>
                   </div>`
            // $(".other-one-first").css("display","none");
            $(".other-one").append(str);
            // $(".other-two-first").css("display","none");
            let str1=`
             <div class="other-two-first">
                      <span>${dweather[i].condition}</span>
                      <img src="./img/${dweather[i].weather_icon_id}.png" alt="">
                  </div>`
            $(".other-two").append(str1);

            let str2=`
            <div class="other-ones-first">
                      <span>${dweather[i].wind_direction}</span>
                      <span>${dweather[i].wind_level+"级"}</span>
                  </div>`
            // $(".other-ones-first").css("display","none");
            $(".other-ones").append(str2);
            arrdata.push(dweather[i].date);
            arrhigh.push(dweather[i].high_temperature);
            arrlow.push(dweather[i].low_temperature);
        }
        let myChart = echarts.init(document.getElementById('main'));

        let option = {
            title: {
            },
            tooltip: {},
            legend: {
                data:['最高温度','最低温度']
            },
            xAxis: {
                data:arrdata,
                show:false
            },
            yAxis: {
                show:false
            },
            series: [{
                itemStyle : {
                    normal : {
                        label : {show: true},
                        color:'#FFB74D',
                        lineStyle:{
                            color:'#FFB74D'
                        }
                    }
                },
                name:'温度',
                type: 'line',
                data: arrhigh
            },
                {
                    itemStyle : {
                        normal : {
                            label : {show: true},
                            color:'#4FC3F7',
                            lineStyle:{
                                color:'#4FC3F7'
                            }
                        }
                    },
                    name:'温度',
                    type: 'line',
                    data: arrlow
                }
            ],
        };
        myChart.setOption(option);

    }
    let city;
    $.ajax ({
        type:"get",
        url:"https://www.toutiao.com/stream/widget/local_weather/city/",
        dataType:"jsonp",
        success:function (obj) {
            city=obj.data;
            console.log(city);
            updataCity(city);
        }
    })
    //获取城市信息
    function updataCity(city) {
        for (let i in city) {
            let str=`<h5>${i}</h5>`;
            $(".viewlist>ul").append(str);
            for(let j in city[i]){
                // console.log(j);
                let str=`<li>${j}`;
                $(".viewlist>ul").append(str);
            }
        }
    }
     function ajaxs(con) {
            $.ajax({
                        type:"get",
                        url:"https://www.toutiao.com/stream/widget/local_weather/data/?city="+con+"",
                        dataType:"jsonp",
                        success:function (obj) {
                            tianqi=obj.data;
                            // console.log(city);
                            updata(tianqi);
                        }
                    })
        }
        $(".search>img").click(function () {

           let texts=$("input").val();
            let flag;
            for (let i in city) {
                for(let j in city[i]){
                    console.log(j);
                   if (texts==j){
                       flag=true;
                   }
                }
            }
            if(flag==true){
             let str3=`
                     <div class="history-bottom">                     
           <span>${texts}</span>
       </div>
                `;
                $(".twos").append(str3);
                 $(".history>img").click(function () {
                $(".history-bottom").remove();
            })
                $(".select").css("display","none");
                $(".other-two-first").css("display","none");
                $(".weather-one").css("display","none");
                $(".other-one-first").css("display","none");
                $(".other-ones-first").css("display","none");
                $(".dingwei>p").html(texts);
            }
            else{
              alert("输入格式错误");

            }
            ajaxs(texts);
        })


    $(".dingwei>p").click(function () {
        let cons=$(this).html();
        $(".select").css("display","none");
        $(".other-two-first").css("display","none");
        $(".weather-one").css("display","none");
        $(".other-one-first").css("display","none");
        $(".other-ones-first").css("display","none");
        let str4=`
                     <div class="history-bottom">
           <span>${cons}</span>
       </div>`;
        $(".twos").append(str4);
        $(".history>img").click(function () {
            $(".history-bottom").remove();
        })
        ajaxs(cons);
    })
    // $(".viewlist>ul>li").click(function () {
    //     // $(".weather>div.container").css("display","none");
    //     let con=$(this).html();
    //     $(".select").css("display","none");
    //     $(".other-two-first").css("display","none");
    //     $(".weather-one").css("display","none");
    //     $(".other-one-first").css("display","none");
    //     $(".other-ones-first").css("display","none");
    //     let str3=`
    //                  <div class="history-bottom">
    //        <span>${con}</span>
    //    </div>
    //             `;
    //     $(".twos").append(str3);
    //     $(".history>img").click(function () {
    //         $(".history-bottom").remove();
    //     })

    //     ajaxs(con);
    // })
       

    $(".main-center").click(function () {
        $(".select").css('display',"block");
    })
    $(".search>span").click(function () {
        $(".select").css('display',"none");
    })
</script>